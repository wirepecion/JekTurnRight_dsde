import pandas as pd
import ast

# --- Input Data (The JavaScript array content) ---
js_array_data = """
[
    [13.70791,100.58363,'สนข.คลองเตย','0.0','0.0','19/11/2568 21:45','ibox-content bg-success','30','คลองเตย','Rain_Green.png','ระดับน้ำปกติ','0.0','0.0','0.0','0.0','0.0','RF.KTY.01','2'],

    [13.70870,100.55457,'ส.พระราม 4','0.0','0.0','19/11/2568 21:45','ibox-content bg-success','80','คลองเตย','Rain_Green.png','ระดับน้ำปกติ','0.0','0.0','0.0','0.0','0.0','RF.KTY.02','2'],

    [13.70857,100.59542,'ส.พระโขนง','0.0','0.0','19/11/2568 21:45','ibox-content bg-success','81','คลองเตย','Rain_Green.png','ระดับน้ำปกติ','0.0','0.0','0.0','0.0','0.0','RF.KTY.03','2'],

    [13.70628,100.58752,'ส.คลองเตย','0.0','0.0','19/11/2568 21:45','ibox-content bg-success','82','คลองเตย','Rain_Green.png','ระดับน้ำปกติ','0.0','0.0','0.0','0.0','0.0','RF.KTY.04','2'],

    [13.73159,100.56745,'จุดวัดสวนเบญจสิริ','0.0','0.0','19/11/2568 21:45','ibox-content bg-success','95','คลองเตย','Rain_Green.png','ระดับน้ำปกติ','0.0','0.0','0.0','0.0','0.0','RF.KTY.05','2'],

    [13.73044,100.50947,'สนข.คลองสาน','0.0','0.0','19/11/2568 21:45','ibox-content bg-success','34','คลองสาน','Rain_Green.png','ระดับน้ำปกติ','0.0','0.0','0.0','0.0','0.0','RF.KSN.01','2'],

    [13.70692,100.49737,'ส.คลองบางไส้ไก่','0.0','0.0','19/11/2568 21:40','ibox-content bg-success','125','คลองสาน','Rain_Green.png','ระดับน้ำปกติ','0.0','0.0','0.0','0.0','0.0','RF.KSN.02','2'],

    [13.85990,100.70424,'สนข.คลองสามวา','0.0','0.0','19/11/2568 21:45','ibox-content bg-success','21','คลองสามวา','Rain_Green.png','ระดับน้ำปกติ','0.0','0.0','0.0','0.0','0.0','RF.KSW.01','2'],

    [13.85954,100.72909,'ปตร.คลองสามวา','0.0','0.0','19/11/2568 21:45','ibox-content bg-success','58','คลองสามวา','Rain_Green.png','ระดับน้ำปกติ','0.0','0.0','0.0','0.0','0.0','RF.KSW.02','2'],

    [13.92046,100.79228,'จุดวัด ค.เก้า-วัดศรีสุขฯ','0.0','0.0','19/11/2568 21:45','ibox-content bg-success','96','คลองสามวา','Rain_Green.png','ระดับน้ำปกติ','0.0','0.0','0.0','0.0','0.0','RF.KSW.03','2'],

    [13.83637,100.66131,'จุดวัด ค.ลำชะล่า-ถ.นวมินทร์','0.0','0.0','19/11/2568 21:45','ibox-content bg-success','61','คันนายาว','Rain_Green.png','ระดับน้ำปกติ','0.0','0.0','0.0','0.0','0.0','RF.KNY.02','2'],

    [13.80967,100.57498,'บ่อสูบศาลอาญารัชดา','0.0','0.0','19/11/2568 21:45','ibox-content bg-success','12','จตุจักร','Rain_Green.png','ระดับน้ำปกติ','0.0','0.0','0.0','0.0','0.0','RF.CTC.01','2'],

    [13.83022,100.55723,'ส.รัชดา-วิภาวดี','0.0','0.0','19/11/2568 21:45','ibox-content bg-success','93','จตุจักร','Rain_Green.png','ระดับน้ำปกติ','0.0','0.0','0.0','0.0','0.0','RF.CTC.02','2'],

    [13.83978,100.54175,'จุดวัด ถ.เทศบาลสงเคราะห์','0.0','0.0','19/11/2568 21:45','ibox-content bg-success','51','จตุจักร','Rain_Green.png','ระดับน้ำปกติ','0.0','0.0','0.0','0.0','0.0','RF.CTC.03','2'],

    [13.67744,100.48427,'สนข.จอมทอง','0.0','0.0','19/11/2568 21:45','ibox-content bg-success','40','จอมทอง','Rain_Green.png','ระดับน้ำปกติ','0.0','0.0','0.0','0.0','0.0','RF.JTG.01','2'],

    [13.70123,100.46491,'จุดวัด ค.สนามชัย-ค.บางขุนเทียน','0.0','0.0','19/11/2568 21:45','ibox-content bg-success','115','จอมทอง','Rain_Green.png','ระดับน้ำปกติ','0.0','0.0','0.0','0.0','0.0','RF.JTG.02','2'],

    [13.67325,100.44615,'ส.คลองสี่บาท','0.0','0.0','19/11/2568 21:45','ibox-content bg-success','118','จอมทอง','Rain_Green.png','ระดับน้ำปกติ','0.0','0.0','0.0','0.0','0.0','RF.JTG.03','2'],

    [13.91053,100.59492,'สนข.ดอนเมือง','0.0','0.0','19/11/2568 21:45','ibox-content bg-success','14','ดอนเมือง','Rain_Green.png','ระดับน้ำปกติ','0.0','0.0','0.0','0.0','0.0','RF.DMG.01','2'],

    [13.76902,100.55452,'ศูนย์ฯ (ดินแดง)','0.0','0.0','19/11/2568 21:45','ibox-content bg-success','55','ดินแดง','Rain_Green.png','ระดับน้ำปกติ','0.0','0.0','0.0','0.0','0.0','RF.DDG.02','2'],

    [13.77693,100.52032,'สนข.ดุสิต','0.0','0.0','19/11/2568 21:45','ibox-content bg-success','9','ดุสิต','Rain_Green.png','ระดับน้ำปกติ','0.0','0.0','0.0','0.0','0.0','RF.DST.01','2'],

    [13.78483,100.50825,'ส.สามเสน','0.0','0.0','19/11/2568 21:45','ibox-content bg-success','68','ดุสิต','Rain_Green.png','ระดับน้ำปกติ','0.0','0.0','0.0','0.0','0.0','RF.DST.02','2'],

    [13.77663,100.45653,'สนข.ตลิ่งชัน','0.0','0.0','19/11/2568 21:45','ibox-content bg-success','38','ตลิ่งชัน','Rain_Green.png','ระดับน้ำปกติ','0.0','0.5','0.5','0.0','0.0','RF.TLC.01','2'],

    [13.79974,100.41609,'ปตร.คลองบัว-ทางรถไฟ','0.0','0.0','19/11/2568 21:45','ibox-content bg-success','107','ตลิ่งชัน','Rain_Green.png','ระดับน้ำปกติ','0.0','0.0','0.0','0.0','0.0','RF.TLC.02','2'],

    [13.77892,100.46500,'ส.คลองชักพระ','0.0','0.0','19/11/2568 21:45','ibox-content bg-success','108','ตลิ่งชัน','Rain_Green.png','ระดับน้ำปกติ','0.0','0.5','0.5','0.5','0.0','RF.TLC.03','2'],

    [13.77281,100.35324,'สนข.ทวีวัฒนา','0.0','0.0','19/11/2568 21:45','ibox-content bg-success','43','ทวีวัฒนา','Rain_Green.png','ระดับน้ำปกติ','0.0','0.0','0.0','0.0','0.0','RF.TWW.01','2'],

    [13.80042,100.32959,'ปตร.คลองทวีวัฒนา','0.0','0.0','19/11/2568 21:45','ibox-content bg-success','106','ทวีวัฒนา','Rain_Green.png','ระดับน้ำปกติ','0.0','1.0','1.0','1.0','0.0','RF.TWW.02','2'],

    [13.80244,100.37070,'ปตร.คลองขุนศรีฯ-ค.มหาสวัสดิ์','0.0','0.0','19/11/2568 21:45','ibox-content bg-success','126','ทวีวัฒนา','Rain_Green.png','ระดับน้ำปกติ','0.0','0.0','0.0','0.0','0.0','RF.TWW.03','2'],

    [13.75037,100.35351,'จุดวัด ค.ทวีฯ-ค.บางเชือกหนัง','0.0','0.0','19/11/2568 21:45','ibox-content bg-success','128','ทวีวัฒนา','Rain_Green.png','ระดับน้ำปกติ','0.0','0.0','0.0','0.0','0.0','RF.TWW.04','2'],

    [13.61135,100.50878,'สนข.ทุ่งครุ','0.0','0.0','19/11/2568 21:45','ibox-content bg-success','42','ทุ่งครุ','Rain_Green.png','ระดับน้ำปกติ','0.0','0.0','0.0','0.0','0.0','RF.TKU.01','2'],

    [13.63494,100.50218,'ปตร.คลองรางจาก-ถ.ประชาอุทิศ','0.0','0.0','19/11/2568 21:45','ibox-content bg-success','120','ทุ่งครุ','Rain_Green.png','ระดับน้ำปกติ','0.0','0.0','0.0','0.0','0.0','RF.TKU.02','2'],

    [13.72497,100.48558,'สนข.ธนบุรี','0.0','0.0','19/11/2568 21:45','ibox-content bg-success','33','ธนบุรี','Rain_Green.png','ระดับน้ำปกติ','0.0','0.0','0.0','0.0','0.0','RF.TBR.01','2'],

    [13.70670,100.49646,'ส.คลองสำเหร่','0.0','0.0','19/11/2568 21:45','ibox-content bg-success','114','ธนบุรี','Rain_Green.png','ระดับน้ำปกติ','0.0','0.0','0.0','0.0','0.0','RF.TBR.02','2'],

    [13.69490,100.48758,'ส.ดาวคะนอง','0.0','0.0','19/11/2568 21:45','ibox-content bg-success','116','ธนบุรี','Rain_Green.png','ระดับน้ำปกติ','0.0','0.0','0.0','0.0','0.0','RF.TBR.03','2'],

    [13.77078,100.46806,'สนข.บางกอกน้อย','0.0','0.0','19/11/2568 21:30','ibox-content black-bg','35','บางกอกน้อย','Rain_Gray.png','การสื่อสารขัดข้อง','0.0','0.0','0.0','0.0','0.0','RF.BKN.01','1'],

    [13.74714,100.48531,'ส.คลองมอญ','0.0','0.0','19/11/2568 21:45','ibox-content bg-success','109','บางกอกน้อย','Rain_Green.png','ระดับน้ำปกติ','0.0','0.0','0.0','0.0','0.0','RF.BKN.02','2'],

    [13.72332,100.47622,'สนข.บางกอกใหญ่','0.0','0.0','19/11/2568 21:45','ibox-content bg-success','36','บางกอกใหญ่','Rain_Green.png','ระดับน้ำปกติ','0.0','0.0','0.0','0.0','0.0','RF.BKY.01','2'],

    [13.74022,100.49012,'ส.คลองบางกอกใหญ่','0.0','0.0','19/11/2568 21:45','ibox-content bg-success','111','บางกอกใหญ่','Rain_Green.png','ระดับน้ำปกติ','0.0','0.0','0.0','0.0','0.0','RF.BKY.02','2'],

    [13.76528,100.64773,'จุดวัด ค.แสนแสบ-เขตบางกะปิ','0.0','0.0','19/11/2568 21:45','ibox-content bg-success','72','บางกะปิ','Rain_Green.png','ระดับน้ำปกติ','0.0','0.0','0.0','0.0','0.0','RF.BKP.02','2'],

    [13.66083,100.43531,'สนข.บางขุนเทียน','0.0','0.0','19/11/2568 21:45','ibox-content bg-success','46','บางขุนเทียน','Rain_Green.png','ระดับน้ำปกติ','0.0','0.0','0.0','0.0','0.0','RF.BKT.01','2'],

    [13.60700,100.41311,'ส.คลองเลนเปน','0.0','0.0','19/11/2568 21:45','ibox-content bg-success','121','บางขุนเทียน','Rain_Green.png','ระดับน้ำปกติ','0.0','0.0','0.0','0.0','0.0','RF.BKT.02','2'],

    [13.60381,100.39465,'ส.คลองระหาญ','0.0','0.0','19/11/2568 21:45','ibox-content bg-success','122','บางขุนเทียน','Rain_Green.png','ระดับน้ำปกติ','0.0','0.0','0.0','0.0','0.0','RF.BKT.03','2'],

    [13.62782,100.43940,'ส.คลองราชมนตรี','0.0','0.0','19/11/2568 21:45','ibox-content bg-success','123','บางขุนเทียน','Rain_Green.png','ระดับน้ำปกติ','0.0','0.0','0.0','0.0','0.0','RF.BKT.04','2'],

    [13.63802,100.44763,'ส.คลองสนามชัย','0.0','0.0','19/11/2568 21:45','ibox-content bg-success','131','บางขุนเทียน','Rain_Green.png','ระดับน้ำปกติ','0.0','0.5','0.5','0.5','0.0','RF.BKT.05','2'],

    [13.87349,100.59643,'สนข.บางเขน','0.0','0.0','19/11/2568 21:45','ibox-content bg-success','16','บางเขน','Rain_Green.png','ระดับน้ำปกติ','0.0','0.0','0.0','0.0','0.0','RF.BKA.01','2'],

    [13.85796,100.58682,'จุดวัด ค.บางบัว','0.0','0.0','19/11/2568 21:45','ibox-content bg-success','59','บางเขน','Rain_Green.png','ระดับน้ำปกติ','0.0','0.0','0.0','0.0','0.0','RF.BKA.02','2'],

    [13.69311,100.50229,'สนข.บางคอแหลม','0.0','0.0','19/11/2568 21:45','ibox-content bg-success','6','บางคอแหลม','Rain_Green.png','ระดับน้ำปกติ','0.0','0.0','0.0','0.0','0.0','RF.BKL.01','2'],

    [13.68653,100.51643,'ส.วัดไทร','0.0','0.0','19/11/2568 21:45','ibox-content bg-success','84','บางคอแหลม','Rain_Green.png','ระดับน้ำปกติ','0.0','0.5','0.5','0.0','0.0','RF.BKL.02','2'],

    [13.69622,100.40919,'สนข.บางแค','0.0','0.0','19/11/2568 21:45','ibox-content bg-success','44','บางแค','Rain_Green.png','ระดับน้ำปกติ','0.0','0.0','0.0','0.0','0.0','RF.BKE.01','2'],

    [13.70754,100.42622,'ค.ราชมนตรี-ภาษีเจริญ','0.0','0.0','19/11/2568 21:45','ibox-content bg-success','113','บางแค','Rain_Green.png','ระดับน้ำปกติ','0.0','0.5','0.5','0.5','0.0','RF.BKE.02','2'],

    [13.71471,100.39555,'ส.คลองบางจาก','0.0','0.0','19/11/2568 21:45','ibox-content bg-success','53','บางแค','Rain_Green.png','ระดับน้ำปกติ','0.0','0.0','0.0','0.0','0.0','RF.BKE.03','2'],

    [13.72167,100.37676,'หมู่บ้านเศรษฐกิจ ซอย 26','0.0','0.0','19/11/2568 21:40','ibox-content bg-success','24','บางแค','Rain_Green.png','ระดับน้ำปกติ','0.0','0.0','0.0','0.0','0.0','RF.BKE.04','2'],

    [13.80973,100.53723,'สนข.บางซื่อ','0.0','0.0','19/11/2568 21:45','ibox-content bg-success','10','บางซื่อ','Rain_Green.png','ระดับน้ำปกติ','0.0','0.0','0.0','0.0','0.0','RF.BSU.01','2'],

    [13.81729,100.51050,'ส.คลองบางเขนใหม่','0.0','0.0','19/11/2568 21:45','ibox-content bg-success','63','บางซื่อ','Rain_Green.png','ระดับน้ำปกติ','0.0','0.0','0.0','0.0','0.0','RF.BSU.02','2'],

    [13.80023,100.51848,'ส.คลองบางซื่อ','0.0','0.0','19/11/2568 21:45','ibox-content bg-success','65','บางซื่อ','Rain_Green.png','ระดับน้ำปกติ','0.0','0.0','0.0','0.0','0.0','RF.BSU.03','2'],

    [13.80501,100.52844,'ซ.สะพานขวา ','0.0','0.0','19/11/2568 21:45','ibox-content bg-success','48','บางซื่อ','Rain_Green.png','ระดับน้ำปกติ','0.0','0.5','0.0','0.0','0.0','RF.BSU.04','2'],

    [13.68095,100.59184,'สนข.บางนา','0.0','0.0','19/11/2568 21:45','ibox-content bg-success','32','บางนา','Rain_Green.png','ระดับน้ำปกติ','0.0','0.5','0.5','0.5','0.0','RF.BNA.01','2'],

    [13.67493,100.58757,'ส.บางนา','0.0','0.0','19/11/2568 21:45','ibox-content bg-success','86','บางนา','Rain_Green.png','ระดับน้ำปกติ','0.0','0.0','0.0','0.0','0.0','RF.BNA.02','2'],

    [13.66106,100.63942,'จุดวัด ค.บางนา-ถ.ศรีนครินทร์','0.0','0.0','19/11/2568 21:45','ibox-content bg-success','87','บางนา','Rain_Green.png','ระดับน้ำปกติ','0.0','0.0','0.0','0.0','0.0','RF.BNA.03','2'],

    [13.63392,100.36884,'สนข.บางบอน','0.0','0.0','19/11/2568 21:45','ibox-content bg-success','45','บางบอน','Rain_Green.png','ระดับน้ำปกติ','0.0','0.0','0.0','0.0','0.0','RF.BBN.01','2'],

    [13.64255,100.37952,'จุดวัด ค.บางบอน-ค.สะแกงาม','0.0','0.0','19/11/2568 21:45','ibox-content bg-success','130','บางบอน','Rain_Green.png','ระดับน้ำปกติ','0.0','0.0','0.0','0.0','0.0','RF.BBN.02','2'],

    [13.79429,100.50479,'สนข.บางพลัด','0.0','0.0','19/11/2568 21:45','ibox-content bg-success','37','บางพลัด','Rain_Green.png','ระดับน้ำปกติ','0.0','0.0','0.0','0.0','0.0','RF.BPD.01','2'],

    [13.73067,100.52382,'สนข.บางรัก','0.0','0.0','19/11/2568 21:45','ibox-content bg-success','4','บางรัก','Rain_Green.png','ระดับน้ำปกติ','0.0','0.0','0.0','0.0','0.0','RF.BRK.01','2'],

    [13.73042,100.51397,'ส.กรุงเกษม','0.0','0.0','19/11/2568 21:45','ibox-content bg-success','75','บางรัก','Rain_Green.png','ระดับน้ำปกติ','0.0','0.0','0.0','0.0','0.0','RF.BRK.02','2'],

    [13.78550,100.66949,'สนข.บึงกุ่ม','0.0','0.0','19/11/2568 21:45','ibox-content bg-success','28','บึงกุ่ม','Rain_Green.png','ระดับน้ำปกติ','0.0','0.0','0.0','0.0','0.0','RF.BKM.01','2'],

    [13.74493,100.52220,'สนข.ปทุมวัน','0.0','0.0','19/11/2568 21:45','ibox-content bg-success','8','ปทุมวัน','Rain_Green.png','ระดับน้ำปกติ','0.0','0.0','0.0','0.0','0.0','RF.PTW.01','2'],

    [13.74807,100.53618,'ปตร.คลองอรชร','0.0','0.0','19/11/2568 21:45','ibox-content bg-success','94','ปทุมวัน','Rain_Green.png','ระดับน้ำปกติ','0.0','0.0','0.0','0.0','0.0','RF.PTW.02','2'],

    [13.71701,100.69472,'สนข.ประเวศ','0.0','0.0','19/11/2568 21:45','ibox-content bg-success','26','ประเวศ','Rain_Green.png','ระดับน้ำปกติ','0.0','0.5','0.5','0.0','0.0','RF.PWT.01','2'],

    [13.72410,100.68957,'ปตร.วัดกระทุ่มฯ','0.0','0.0','19/11/2568 21:45','ibox-content bg-success','77','ประเวศ','Rain_Green.png','ระดับน้ำปกติ','0.0','0.5','0.5','0.0','0.0','RF.PWT.02','2'],

    [13.69529,100.65375,'จุดวัดบึงหนองบอน','0.0','0.0','19/11/2568 21:45','ibox-content bg-success','105','ประเวศ','Rain_Green.png','ระดับน้ำปกติ','0.0','0.5','0.5','0.0','0.0','RF.PWT.03','2'],

    [13.75826,100.51304,'สนข.ป้อมปราบฯ','0.0','0.0','19/11/2568 21:45','ibox-content bg-success','2','ป้อมปราบฯ','Rain_Green.png','ระดับน้ำปกติ','0.0','0.5','0.5','0.5','0.0','RF.PPS.01','2'],

    [13.78003,100.54287,'สนข.พญาไท','0.0','0.0','19/11/2568 21:45','ibox-content bg-success','11','พญาไท','Rain_Green.png','ระดับน้ำปกติ','0.0','0.0','0.0','0.0','0.0','RF.PYT.01','2'],

    [13.77292,100.52991,'ค.สามเสน ถ.พระราม 6','0.0','0.0','19/11/2568 21:45','ibox-content bg-success','132','พญาไท','Rain_Green.png','ระดับน้ำปกติ','0.0','0.5','0.5','0.0','0.0','RF.PYT.02','2'],

    [13.70233,100.60197,'สนข.พระโขนง','0.0','0.0','19/11/2568 21:45','ibox-content bg-success','31','พระโขนง','Rain_Green.png','ระดับน้ำปกติ','0.0','0.0','0.0','0.0','0.0','RF.PKN.01','2'],

    [13.69223,100.58991,'ส.คลองเจ็ก','0.0','0.0','19/11/2568 21:45','ibox-content bg-success','83','พระโขนง','Rain_Green.png','ระดับน้ำปกติ','0.0','0.0','0.0','0.0','0.0','RF.PKN.02','2'],

    [13.68212,100.59254,'ส.บางอ้อ','0.0','0.0','19/11/2568 21:45','ibox-content bg-success','85','พระโขนง','Rain_Green.png','ระดับน้ำปกติ','0.0','0.0','0.0','0.0','0.0','RF.PKN.03','2'],

    [13.68910,100.59068,'ส.บางจาก','0.0','0.0','19/11/2568 21:45','ibox-content bg-success','91','พระโขนง','Rain_Green.png','ระดับน้ำปกติ','0.0','0.0','0.0','0.0','0.0','RF.PKN.04','2'],

    [13.76490,100.49872,'สนข.พระนคร','0.0','0.0','19/11/2568 21:40','ibox-content bg-success','1','พระนคร','Rain_Green.png','ระดับน้ำปกติ','0.0','0.0','0.0','0.0','0.0','RF.PNK.01','2'],

    [13.77191,100.50110,'ส.เทเวศร์','0.0','0.0','19/11/2568 21:45','ibox-content bg-success','70','พระนคร','Rain_Green.png','ระดับน้ำปกติ','0.0','0.5','0.5','0.0','0.0','RF.PNK.02','2'],

    [13.74228,100.49454,'ปากคลองตลาด','0.0','0.0','19/11/2568 21:45','ibox-content bg-success','54','พระนคร','Rain_Green.png','ระดับน้ำปกติ','0.0','0.0','0.0','0.0','0.0','RF.PNK.03','2'],

    [13.71441,100.43696,'สนข.ภาษีเจริญ','0.0','0.0','19/11/2568 21:45','ibox-content bg-success','39','ภาษีเจริญ','Rain_Green.png','ระดับน้ำปกติ','0.0','0.0','0.0','0.0','0.0','RF.PSC.01','2'],

    [13.74223,100.42765,'จุดวัด ค.บางเชือกหนัง-ถ.พุทธมณฑลสาย 1','0.0','0.0','19/11/2568 21:45','ibox-content bg-success','110','ภาษีเจริญ','Rain_Green.png','ระดับน้ำปกติ','0.0','0.0','0.0','0.0','0.0','RF.PSC.03','2'],

    [13.72204,100.46863,'ส.คลองภาษีเจริญ','0.0','0.0','19/11/2568 21:45','ibox-content bg-success','112','ภาษีเจริญ','Rain_Green.png','ระดับน้ำปกติ','0.0','0.0','0.0','0.0','0.0','RF.PSC.04','2'],

    [13.74357,100.45954,'จุดวัด ค.บางเชือกหนัง-วัดปากน้ำฝั่งใต้','0.0','0.0','19/11/2568 21:45','ibox-content bg-success','127','ภาษีเจริญ','Rain_Green.png','ระดับน้ำปกติ','0.0','0.0','0.0','0.0','0.0','RF.PSC.05','2'],

    [13.81360,100.73122,'สนข.มีนบุรี','0.0','0.0','19/11/2568 21:45','ibox-content bg-success','22','มีนบุรี','Rain_Green.png','ระดับน้ำปกติ','0.0','0.0','0.0','0.0','0.0','RF.MBR.01','2'],

    [13.82120,100.74717,'ปตร.ประชาร่วมใจ','0.0','0.0','19/11/2568 21:45','ibox-content bg-success','62','มีนบุรี','Rain_Green.png','ระดับน้ำปกติ','0.0','0.0','0.0','0.0','0.0','RF.MBR.02','2'],

    [13.80045,100.78827,'จุดวัด ค.บึงใหญ่-วัดทองสัมฤทธิ์','0.0','0.0','19/11/2568 21:45','ibox-content bg-success','101','มีนบุรี','Rain_Green.png','ระดับน้ำปกติ','0.0','0.0','0.0','0.0','0.0','RF.MBR.05','2'],

    [13.69627,100.54222,'สนข.ยานนาวา','0.0','0.0','19/11/2568 21:45','ibox-content bg-success','7','ยานนาวา','Rain_Green.png','ระดับน้ำปกติ','0.0','0.0','0.0','0.0','0.0','RF.YNW.01','2'],

    [13.69493,100.54874,'ส.คลองช่องนนทรี','0.0','0.0','19/11/2568 21:45','ibox-content bg-success','90','ยานนาวา','Rain_Green.png','ระดับน้ำปกติ','0.0','0.0','0.0','0.0','0.0','RF.YNW.02','2'],

    [13.67071,100.54018,'ปตร.คลองวัดด่าน','0.0','0.0','19/11/2568 21:45','ibox-content bg-success','92','ยานนาวา','Rain_Green.png','ระดับน้ำปกติ','0.0','0.0','0.0','0.0','0.0','RF.YNW.03','2'],

    [13.75917,100.53405,'สนข.ราชเทวี','0.0','0.0','19/11/2568 21:45','ibox-content bg-success','19','ราชเทวี','Rain_Green.png','ระดับน้ำปกติ','0.0','0.0','0.0','0.0','0.0','RF.RTW.01','2'],

    [13.75665,100.54839,'จุดวัดบึงมักกะสัน','0.0','0.0','19/11/2568 21:45','ibox-content bg-success','52','ราชเทวี','Rain_Green.png','ระดับน้ำปกติ','0.0','0.0','0.0','0.0','0.0','RF.RTW.03','2'],

    [13.68207,100.50586,'สนข.ราษฎร์บูรณะ','0.0','0.0','19/11/2568 21:45','ibox-content bg-success','41','ราษฏร์บูรณะ','Rain_Green.png','ระดับน้ำปกติ','0.0','0.0','0.0','0.0','0.0','RF.RBN.01','2'],

    [13.67627,100.52097,'ส.คลองแจงร้อน','0.0','0.0','19/11/2568 21:45','ibox-content bg-success','119','ราษฏร์บูรณะ','Rain_Green.png','ระดับน้ำปกติ','0.0','0.0','0.0','0.0','0.0','RF.RBN.02','2'],

    [13.72386,100.74979,'ปตร.คลองประเวศฯ-ลาดกระบัง','0.0','0.0','19/11/2568 21:45','ibox-content bg-success','76','ลาดกระบัง','Rain_Green.png','ระดับน้ำปกติ','0.0','0.5','0.5','0.0','0.0','RF.LKB.02','2'],

    [13.72398,100.78407,'ค.ประเวศฯ-รพ.ลาดกระบัง','0.0','0.0','19/11/2568 21:45','ibox-content bg-success','103','ลาดกระบัง','Rain_Green.png','ระดับน้ำปกติ','0.0','0.0','0.0','0.0','0.0','RF.LKB.03','2'],

    [13.70097,100.85106,'จุดวัด ค.ประเวศฯ-ถ.ร่วมพัฒนา','0.0','0.0','19/11/2568 21:45','ibox-content bg-success','104','ลาดกระบัง','Rain_Green.png','ระดับน้ำปกติ','0.0','0.0','0.0','0.0','0.0','RF.LKB.04','2'],

    [13.80353,100.60746,'สนข.ลาดพร้าว','0.0','0.0','19/11/2568 21:45','ibox-content bg-success','20','ลาดพร้าว','Rain_Green.png','ระดับน้ำปกติ','0.0','0.0','0.0','0.0','0.0','RF.LPW.01','2'],

    [13.76435,100.60553,'สนข.วังทองหลาง','0.0','0.0','19/11/2568 21:45','ibox-content bg-success','18','วังทองหลาง','Rain_Green.png','ระดับน้ำปกติ','0.0','0.0','0.0','0.0','0.0','RF.WTL.01','2'],

    [13.79432,100.58933,'ปตร.คลองลาดพร้าว','0.0','0.0','19/11/2568 21:45','ibox-content bg-success','67','วังทองหลาง','Rain_Green.png','ระดับน้ำปกติ','0.0','0.0','0.0','0.0','0.0','RF.WTL.02','2'],

    [13.76160,100.61525,'ส.คลองเจ้าคุณสิงห์','0.0','0.0','19/11/2568 21:45','ibox-content bg-success','69','วังทองหลาง','Rain_Green.png','ระดับน้ำปกติ','0.0','0.0','0.0','0.0','0.0','RF.WTL.03','2'],

    [13.74248,100.58571,'สนข.วัฒนา','0.0','0.0','19/11/2568 21:45','ibox-content bg-success','29','วัฒนา','Rain_Green.png','ระดับน้ำปกติ','0.0','0.0','0.0','0.0','0.0','RF.WTN.01','2'],

    [13.74110,100.59640,'ส.แสนแสบ-คลองตัน','0.0','0.0','19/11/2568 21:45','ibox-content bg-success','74','วัฒนา','Rain_Green.png','ระดับน้ำปกติ','0.0','0.0','0.0','0.0','0.0','RF.WTN.02','2'],

    [13.73043,100.65154,'สนข.สวนหลวง','0.0','0.0','19/11/2568 21:30','ibox-content black-bg','27','สวนหลวง','Rain_Gray.png','การสื่อสารขัดข้อง','0.0','0.0','0.0','0.0','0.0','RF.SLG.01','1'],

    [13.71545,100.64150,'จุดวัด ค.ประเวศฯ-วัดขจรศิริ','0.0','0.0','19/11/2568 21:45','ibox-content bg-success','79','สวนหลวง','Rain_Green.png','ระดับน้ำปกติ','0.0','0.5','0.5','0.0','0.0','RF.SLG.02','2'],

    [13.76881,100.68545,'สนข.สะพานสูง','0.0','0.0','19/11/2568 21:40','ibox-content bg-success','25','สะพานสูง','Rain_Green.png','ระดับน้ำปกติ','0.0','0.0','0.0','0.0','0.0','RF.SPS.01','2'],

    [13.79734,100.70451,'ปตร.คลองแสนแสบ-บางชัน','0.0','0.0','19/11/2568 21:45','ibox-content bg-success','66','สะพานสูง','Rain_Green.png','ระดับน้ำปกติ','0.0','0.0','0.0','0.0','0.0','RF.SPS.02','2'],

    [13.73664,100.50960,'ท่าน้ำสวัสดี','0.0','0.0','19/11/2568 21:45','ibox-content bg-success','3','สัมพันธวงศ์','Rain_Green.png','ระดับน้ำปกติ','0.0','0.0','0.0','0.0','0.0','RF.SPW.01','2'],

    [13.70821,100.52641,'สนข.สาทร','0.0','0.0','19/11/2568 21:45','ibox-content bg-success','5','สาทร','Rain_Green.png','ระดับน้ำปกติ','0.0','0.5','0.5','0.0','0.0','RF.STN.01','2'],

    [13.71839,100.51496,'ส.คลองสาทร','0.0','0.0','19/11/2568 21:45','ibox-content bg-success','78','สาทร','Rain_Green.png','ระดับน้ำปกติ','0.0','0.0','0.0','0.0','0.0','RF.STN.02','2'],

    [13.89531,100.66090,'สนข.สายไหม','0.0','0.0','19/11/2568 21:45','ibox-content bg-success','15','สายไหม','Rain_Green.png','ระดับน้ำปกติ','0.0','0.0','0.0','0.0','0.0','RF.SMI.01','2'],

    [13.92314,100.63447,'ปตร.คลองสองสายใต้','0.0','0.0','19/11/2568 21:45','ibox-content bg-success','56','สายไหม','Rain_Green.png','ระดับน้ำปกติ','0.0','0.0','0.0','0.0','0.0','RF.SMI.02','2'],

    [13.92126,100.68741,'ปตร.พระยาสุเรนทร์','0.0','0.0','19/11/2568 21:45','ibox-content bg-success','57','สายไหม','Rain_Green.png','ระดับน้ำปกติ','0.0','0.0','0.0','0.0','0.0','RF.SMI.03','2'],

    [13.93786,100.62661,'จุดวัด ซ.แอนเน็กซ์','0.0','0.0','19/11/2568 21:45','ibox-content bg-success','50','สายไหม','Rain_Green.png','ระดับน้ำปกติ','0.0','0.0','0.0','0.0','0.0','RF.SMI.04','2'],

    [13.70574,100.34931,'สนข.หนองแขม','0.0','0.0','19/11/2568 21:45','ibox-content bg-success','47','หนองแขม','Rain_Green.png','ระดับน้ำปกติ','0.0','0.0','0.0','0.0','0.0','RF.NKM.01','2'],

    [13.69168,100.38097,'จุดวัด ค.ทวีฯ-ค.ภาษีฯ','0.0','0.0','19/11/2568 21:45','ibox-content bg-success','117','หนองแขม','Rain_Green.png','ระดับน้ำปกติ','0.0','0.0','0.0','0.0','0.0','RF.NKM.02','2'],

    [13.85584,100.86259,'สนข.หนองจอก','0.0','0.0','19/11/2568 21:45','ibox-content bg-success','23','หนองจอก','Rain_Green.png','ระดับน้ำปกติ','0.0','0.0','0.0','0.0','0.0','RF.NJK.01','2'],

    [13.85516,100.87292,'ปตร.คลองแสนแสบ','0.0','0.0','19/11/2568 21:45','ibox-content bg-success','89','หนองจอก','Rain_Green.png','ระดับน้ำปกติ','0.0','0.0','0.0','0.0','0.0','RF.NJK.02','2'],

    [13.91368,100.86244,'จุดวัด ค.สิบสอง-ถ.ประชาสำราญ','0.0','0.0','19/11/2568 21:45','ibox-content bg-success','97','หนองจอก','Rain_Green.png','ระดับน้ำปกติ','0.0','0.0','0.0','0.0','0.0','RF.NJK.03','2'],

    [13.81321,100.93742,'ปตร.คลองหลวงแพ่ง','0.0','0.0','19/11/2568 21:45','ibox-content bg-success','100','หนองจอก','Rain_Green.png','ระดับน้ำปกติ','0.0','0.5','0.5','0.5','0.0','RF.NJK.05','2'],

    [13.79205,100.83524,'จุดวัด ค.ลำผักชี-รร.ลำผักชี','0.0','0.0','19/11/2568 21:45','ibox-content bg-success','102','หนองจอก','Rain_Green.png','ระดับน้ำปกติ','0.0','0.5','0.5','0.0','0.0','RF.NJK.06','2'],

    [13.85150,100.80361,'จุดวัด ค.แสนแสบ-วัดทรัพย์ฯ','0.0','0.0','19/11/2568 21:45','ibox-content bg-success','99','หนองจอก','Rain_Green.png','ระดับน้ำปกติ','0.0','0.0','0.0','0.0','0.0','RF.NJK.07','2'],

    [13.88748,100.57893,'สนข.หลักสี่','0.0','0.0','19/11/2568 21:45','ibox-content bg-success','13','หลักสี่','Rain_Green.png','ระดับน้ำปกติ','0.0','0.0','0.0','0.0','0.0','RF.LSI.01','2'],

    [13.89210,100.56383,'จุดวัดศูนย์ราชการ-ถ.แจ้งวัฒนะ','0.0','0.0','19/11/2568 21:45','ibox-content bg-success','49','หลักสี่','Rain_Green.png','ระดับน้ำปกติ','0.0','0.0','0.0','0.0','0.0','RF.LSI.03','2'],

    [13.77678,100.57906,'สนข.ห้วยขวาง','0.0','0.0','19/11/2568 21:45','ibox-content bg-success','17','ห้วยขวาง','Rain_Green.png','ระดับน้ำปกติ','0.0','0.0','0.0','0.0','0.0','RF.HKG.01','2'],

    [13.74842,100.59920,'ส.สามเสน-ค.แสนแสบ','0.0','0.0','19/11/2568 21:45','ibox-content bg-success','73','ห้วยขวาง','Rain_Green.png','ระดับน้ำปกติ','0.0','0.0','0.0','0.0','0.0','RF.HKG.02','2'],

    [13.64819,100.59514,'ส.คลองสำโรง','0.0','0.0','19/11/2568 21:45','ibox-content bg-success','88','อำเภอเมืองสมุทรปราการ','Rain_Green.png','ระดับน้ำปกติ','0.0','0.0','0.0','0.0','0.0','RF.SPK.01','2']
    ]
"""

# --- Column Definitions ---
STATION_COLUMNS = [
    'Latitude', 'Longitude', 'StationName_Short', 'Value_1_Rain_3Hrs', 'Value_2_Rain_6Hrs', 
    'Timestamp', 'StatusClass', 'DistrictCode_from_JS', 'DistrictName', 'Icon', 
    'StatusText', 'Value_4_Rain_12Hrs', 'Value_5_Rain_24Hrs', 'Value_6', 'Value_7', 
    'Value_8', 'StationCode', 'StatusID'
]

def parse_locations_data(data_string):
    """
    Converts the raw JavaScript array string into a structured Pandas DataFrame.
    """
    print("Starting direct data parsing...")
    
    try:
        # 1. Safely evaluate the extracted string into a Python list
        locations_data = ast.literal_eval(data_string)
        
        print(f"✅ Successfully converted data string to list. Found {len(locations_data)} records.")

        # 2. Create DataFrame
        df = pd.DataFrame(locations_data, columns=STATION_COLUMNS)
        
        # 3. Select and clean the most relevant columns
        final_df = df[[
            'StationCode', 
            'StationName_Short', 
            'DistrictName', 
            'Latitude', 
            'Longitude', 
            'Timestamp',
            'DistrictCode_from_JS'
        ]].copy()
        
        # Rename columns to be clearer
        final_df.rename(columns={'Timestamp': 'LastReadingTime'}, inplace=True)
        
        return final_df
        
    except ValueError as e:
        print(f"❌ Error parsing the array data using ast.literal_eval. Check for unmatched quotes or invalid syntax: {e}")
        return None

# --- Execution ---
station_df = parse_locations_data(js_array_data)

if station_df is not None:
    output_file_name = "station_metadata.csv"
    try:
        station_df.to_csv(output_file_name, index=False, encoding="utf-8-sig")
        print("---")
        print(f"✅ Clean Metadata Saved to **{output_file_name}**.")
        print(f"Total stations processed: **{len(station_df)}**.")
        print("\n**Sample Data (First 5 Rows):**")
        print(station_df.head().to_string(index=False))
    except Exception as e:
        print(f"❌ Error saving the final CSV: {e}")